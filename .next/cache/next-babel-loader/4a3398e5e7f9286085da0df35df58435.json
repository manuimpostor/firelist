{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/nnoll/dev/firelist/client/components/editableBlock/index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport react from 'react';\nimport ContentEditable from 'react-contenteditable';\nimport styles from './styles.module.scss';\nimport Bullet from '../bullet';\n\nvar EditableBlock = /*#__PURE__*/function (_React$Component) {\n  _inherits(EditableBlock, _React$Component);\n\n  var _super = _createSuper(EditableBlock);\n\n  function EditableBlock(props) {\n    var _this;\n\n    _classCallCheck(this, EditableBlock);\n\n    _this = _super.call(this, props);\n    _this.handleHTMLChange = _this.handleHTMLChange.bind(_assertThisInitialized(_this));\n    _this.handleShotChange = _this.handleShotChange.bind(_assertThisInitialized(_this));\n    _this.handleKeyDown = _this.handleKeyDown.bind(_assertThisInitialized(_this));\n    _this.htmlRef = /*#__PURE__*/react.createRef();\n    _this.state = {\n      html: \"\",\n      shot: false,\n      previousKey: null\n    };\n    return _this;\n  }\n\n  _createClass(EditableBlock, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.htmlRef.current.addEventListener('keydown', this.handleKeyDown);\n      this.htmlRef.current.focus();\n      this.setState(_objectSpread(_objectSpread({}, this.state), {}, {\n        html: this.props.html,\n        shot: this.props.shot\n      }));\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var htmlChanged = prevState.html !== this.state.html;\n      var shotChanged = prevState.shot !== this.state.shot;\n\n      if (htmlChanged || shotChanged) {\n        this.props.updateBlock({\n          _id: this.props._id,\n          html: this.state.html,\n          shot: this.state.shot\n        });\n      }\n    }\n  }, {\n    key: \"handleHTMLChange\",\n    value: function handleHTMLChange(e) {\n      this.setState(_objectSpread(_objectSpread({}, this.state), {}, {\n        html: e.target.value\n      }));\n    }\n  }, {\n    key: \"handleShotChange\",\n    value: function handleShotChange(shot) {\n      this.setState(_objectSpread(_objectSpread({}, this.state), {}, {\n        shot: !shot\n      }));\n    }\n  }, {\n    key: \"handleKeyDown\",\n    value: function handleKeyDown(e) {\n      if (e.key === \"Enter\") {\n        e.preventDefault();\n        this.props.addBlock({\n          _id: this.props._id,\n          ref: this.htmlRef.current,\n          html: this.state.html,\n          shot: this.state.shot\n        });\n      } else if (e.key === \"Backspace\" && (this.state.html === \"<br>\" || !this.state.html)) {\n        this.props.deleteBlock({\n          _id: this.props._id,\n          ref: this.htmlRef.current\n        }); // TODO focus previous block\n      }\n\n      this.setState({\n        previousKey: e.key\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return __jsx(\"div\", {\n        className: styles.bulletedPoint,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 7\n        }\n      }, __jsx(Bullet, {\n        shot: this.props.shot,\n        onShotChange: this.handleShotChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 9\n        }\n      }), __jsx(ContentEditable, {\n        className: styles.point,\n        innerRef: this.htmlRef,\n        html: this.state.html,\n        onChange: this.handleHTMLChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 9\n        }\n      }));\n    }\n  }]);\n\n  return EditableBlock;\n}(React.Component);\n\nexport default EditableBlock;","map":{"version":3,"sources":["/Users/nnoll/dev/firelist/client/components/editableBlock/index.js"],"names":["react","ContentEditable","styles","Bullet","EditableBlock","props","handleHTMLChange","bind","handleShotChange","handleKeyDown","htmlRef","createRef","state","html","shot","previousKey","current","addEventListener","focus","setState","prevProps","prevState","htmlChanged","shotChanged","updateBlock","_id","e","target","value","key","preventDefault","addBlock","ref","deleteBlock","bulletedPoint","point","React","Component"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,eAAP,MAA4B,uBAA5B;AACA,OAAOC,MAAP,MAAmB,sBAAnB;AACA,OAAOC,MAAP,MAAmB,WAAnB;;IAEMC,a;;;;;AACJ,yBAAYC,KAAZ,EAAkB;AAAA;;AAAA;;AAChB,8BAAMA,KAAN;AACA,UAAKC,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBC,IAAtB,+BAAxB;AACA,UAAKC,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBD,IAAtB,+BAAxB;AACA,UAAKE,aAAL,GAAqB,MAAKA,aAAL,CAAmBF,IAAnB,+BAArB;AACA,UAAKG,OAAL,gBAAeV,KAAK,CAACW,SAAN,EAAf;AACA,UAAKC,KAAL,GAAa;AACXC,MAAAA,IAAI,EAAE,EADK;AAEXC,MAAAA,IAAI,EAAE,KAFK;AAGXC,MAAAA,WAAW,EAAE;AAHF,KAAb;AANgB;AAWjB;;;;wCAEmB;AAClB,WAAKL,OAAL,CAAaM,OAAb,CAAqBC,gBAArB,CAAsC,SAAtC,EAAiD,KAAKR,aAAtD;AACA,WAAKC,OAAL,CAAaM,OAAb,CAAqBE,KAArB;AACA,WAAKC,QAAL,iCACK,KAAKP,KADV;AAEEC,QAAAA,IAAI,EAAE,KAAKR,KAAL,CAAWQ,IAFnB;AAGEC,QAAAA,IAAI,EAAE,KAAKT,KAAL,CAAWS;AAHnB;AAKD;;;uCAEkBM,S,EAAWC,S,EAAW;AACvC,UAAMC,WAAW,GAAGD,SAAS,CAACR,IAAV,KAAmB,KAAKD,KAAL,CAAWC,IAAlD;AACA,UAAMU,WAAW,GAAGF,SAAS,CAACP,IAAV,KAAmB,KAAKF,KAAL,CAAWE,IAAlD;;AACA,UAAIQ,WAAW,IAAIC,WAAnB,EAA+B;AAC7B,aAAKlB,KAAL,CAAWmB,WAAX,CAAuB;AACrBC,UAAAA,GAAG,EAAE,KAAKpB,KAAL,CAAWoB,GADK;AAErBZ,UAAAA,IAAI,EAAE,KAAKD,KAAL,CAAWC,IAFI;AAGrBC,UAAAA,IAAI,EAAE,KAAKF,KAAL,CAAWE;AAHI,SAAvB;AAKD;AACF;;;qCAEgBY,C,EAAG;AAClB,WAAKP,QAAL,iCAAmB,KAAKP,KAAxB;AAA+BC,QAAAA,IAAI,EAAEa,CAAC,CAACC,MAAF,CAASC;AAA9C;AACD;;;qCAEgBd,I,EAAM;AACrB,WAAKK,QAAL,iCAAmB,KAAKP,KAAxB;AAA+BE,QAAAA,IAAI,EAAE,CAACA;AAAtC;AACD;;;kCAEaY,C,EAAG;AACf,UAAIA,CAAC,CAACG,GAAF,KAAU,OAAd,EAAuB;AACrBH,QAAAA,CAAC,CAACI,cAAF;AACA,aAAKzB,KAAL,CAAW0B,QAAX,CAAoB;AAClBN,UAAAA,GAAG,EAAE,KAAKpB,KAAL,CAAWoB,GADE;AAElBO,UAAAA,GAAG,EAAE,KAAKtB,OAAL,CAAaM,OAFA;AAGlBH,UAAAA,IAAI,EAAE,KAAKD,KAAL,CAAWC,IAHC;AAIlBC,UAAAA,IAAI,EAAE,KAAKF,KAAL,CAAWE;AAJC,SAApB;AAMD,OARD,MASK,IAAIY,CAAC,CAACG,GAAF,KAAU,WAAV,KAA0B,KAAKjB,KAAL,CAAWC,IAAX,KAAoB,MAApB,IAA8B,CAAC,KAAKD,KAAL,CAAWC,IAApE,CAAJ,EAA+E;AAClF,aAAKR,KAAL,CAAW4B,WAAX,CAAuB;AAAER,UAAAA,GAAG,EAAE,KAAKpB,KAAL,CAAWoB,GAAlB;AAAuBO,UAAAA,GAAG,EAAE,KAAKtB,OAAL,CAAaM;AAAzC,SAAvB,EADkF,CAElF;AACD;;AACD,WAAKG,QAAL,CAAc;AAAEJ,QAAAA,WAAW,EAAEW,CAAC,CAACG;AAAjB,OAAd;AACD;;;6BAEQ;AACP,aACE;AAAK,QAAA,SAAS,EAAE3B,MAAM,CAACgC,aAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,MAAD;AACE,QAAA,IAAI,EAAE,KAAK7B,KAAL,CAAWS,IADnB;AAEE,QAAA,YAAY,EAAE,KAAKN,gBAFrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAKE,MAAC,eAAD;AACE,QAAA,SAAS,EAAEN,MAAM,CAACiC,KADpB;AAEE,QAAA,QAAQ,EAAE,KAAKzB,OAFjB;AAGE,QAAA,IAAI,EAAE,KAAKE,KAAL,CAAWC,IAHnB;AAIE,QAAA,QAAQ,EAAE,KAAKP,gBAJjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALF,CADF;AAcD;;;;EA5EyB8B,KAAK,CAACC,S;;AAgFlC,eAAejC,aAAf","sourcesContent":["import react from 'react'\nimport ContentEditable from 'react-contenteditable'\nimport styles from './styles.module.scss'\nimport Bullet from '../bullet'\n\nclass EditableBlock extends React.Component {\n  constructor(props){\n    super(props)\n    this.handleHTMLChange = this.handleHTMLChange.bind(this);\n    this.handleShotChange = this.handleShotChange.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.htmlRef = react.createRef();\n    this.state = {\n      html: \"\",\n      shot: false,\n      previousKey: null,\n    }\n  }\n\n  componentDidMount() {\n    this.htmlRef.current.addEventListener('keydown', this.handleKeyDown)\n    this.htmlRef.current.focus()\n    this.setState({\n      ...this.state,\n      html: this.props.html,\n      shot: this.props.shot,\n    })\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const htmlChanged = prevState.html !== this.state.html\n    const shotChanged = prevState.shot !== this.state.shot\n    if (htmlChanged || shotChanged){\n      this.props.updateBlock({\n        _id: this.props._id,\n        html: this.state.html,\n        shot: this.state.shot,\n      })\n    }\n  }\n\n  handleHTMLChange(e) {\n    this.setState({ ...this.state, html: e.target.value })\n  }\n\n  handleShotChange(shot) {\n    this.setState({ ...this.state, shot: !shot })\n  }\n\n  handleKeyDown(e) {\n    if (e.key === \"Enter\") {\n      e.preventDefault()\n      this.props.addBlock({\n        _id: this.props._id,\n        ref: this.htmlRef.current,\n        html: this.state.html,\n        shot: this.state.shot,\n      })\n    }\n    else if (e.key === \"Backspace\" && (this.state.html === \"<br>\" || !this.state.html)) {\n      this.props.deleteBlock({ _id: this.props._id, ref: this.htmlRef.current })\n      // TODO focus previous block\n    }\n    this.setState({ previousKey: e.key })\n  }\n\n  render() {\n    return (\n      <div className={styles.bulletedPoint}>\n        <Bullet\n          shot={this.props.shot}\n          onShotChange={this.handleShotChange}\n        />\n        <ContentEditable\n          className={styles.point}\n          innerRef={this.htmlRef}\n          html={this.state.html}\n          onChange={this.handleHTMLChange}\n        />\n      </div>\n    )\n  }\n}\n\n\nexport default EditableBlock\n"]},"metadata":{},"sourceType":"module"}